Below are instructions on how to setup completion3d training in tensorflow.
New networks can be added following the template in tensorflow/models/TopNet.py 
and adding corresponding import statements in tensorflow/main.py and 
tensorflow/utils/train_utils.py Feel free to submit new model additions to the 
benchmark as a pull request.

## Clone Repository

```
git clone git@github.com:lynetcha/completion3d.git
```

## Install CUDA and CUDNN

Instructions below assume CUDA 9.0 is installed in /usr/local/cuda

```
export PATH=/usr/local/cuda/bin:$PATH
export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
```

FQA: How to install CUDA 9.0 (linux)?
```
!wget https://developer.nvidia.com/compute/cuda/9.0/Prod/local_installers/cuda-repo-ubuntu1604-9-0-local_9.0.176-1_amd64-deb
!dpkg -i cuda-repo-ubuntu1604-9-0-local_9.0.176-1_amd64-deb
!apt-key add /var/cuda-repo-9-0-local/7fa2af80.pub
!apt-get update
!apt-get install cuda=9.0.176-1
```


## Tensorflow Python Environment

```
cd completion3d/tensorflow
PYTHON_BIN=/path/to/python3.6
virtualenv -p $PYTHON_BIN comp3d_tf_venv
source comp3d_tf_venv/bin/activate
pip install -r ../requirements/tensorflow-requirements.txt

```

## Build Chamfer and EMD functions

```
cd utils/pc_distance
make
cd ../../../
```

QA: Somehow your local TF path was not the same as used in the `make` script, which leads to the "missing" c++ header files. You need change:

`original path`
```
tf_inc=$(PYTHON_DIR)/lib/python3.6/site-packages/tensorflow/include
tf_lib=$(PYTHON_DIR)/lib/python3.6/site-packages/tensorflow
```
to 
`real path`
```
tf_inc=/usr/local/lib/python3.6/dist-packages/tensorflow/include
tf_lib=/usr/local/lib/python3.6/dist-packages/tensorflow
```


## Run Tensorflow Training/Testing

```
cd tensorflow
```

Link data (see data-setup.md)

```
ln -s /path/to/data data
```

Modify parameters in *run.sh*

```
chmod +x run.sh
./run.sh
```

## Benchmark submission instructions

To submit to the completion3d benchmark, set ```TRAIN=0``` and ```BENCHMARK=1``` in ```run.sh``` and run the script with parameters to evaluate. A ```submission.zip``` file will be generated by the script in the experiment output folder.
